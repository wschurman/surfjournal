(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{215:function(e,t,n){e.exports=n(261)},261:function(e,t,n){"use strict";n.r(t);var r=n(175),a=n(273),o=n(210),c=n(0),i=n.n(c),u=n(49),l=n(177),s=n(150),m=n(55),d=n(62),f=Object(m.b)({selectId:function(e){return e.id},sortComparer:function(e,t){var n=new Date(e.createdAt),r=new Date(t.createdAt);return n<r?-1:r<n?1:0}}),p=Object(m.c)({name:"journalEntries",initialState:f.getInitialState(),reducers:{journalEntryAdded:f.addOne,deleteJournalEntry:f.removeOne}}),b=f.getSelectors((function(e){return e.journalEntries})),E=Object(m.b)({selectId:function(e){return e.id},sortComparer:function(e,t){return e.name<t.name?-1:t.name<e.name?1:0}}),g=Object(m.c)({name:"spotFavorites",initialState:E.getInitialState(),reducers:{spotFavoriteAdded:E.addOne,removeSpotFavorite:E.removeOne}}),h=E.getSelectors((function(e){return e.spotFavorites})),y={key:"journal_entries",version:1,storage:s.a},v={key:"spot_favorites",version:1,storage:s.a},w=Object(m.a)({reducer:{journalEntries:Object(d.g)(y,p.reducer),spotFavorites:Object(d.g)(v,g.reducer)},middleware:Object(m.d)({serializableCheck:{ignoredActions:[d.a,d.f,d.b,d.c,d.d,d.e]}})}),j=Object(d.h)(w),S=n(270),O=n(272),k=n(271),x=n(269),C=n(10),P=n(4),B=n.n(P);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){B()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){return function(t){var n=t.navigation;return J(J({},e),{},{headerLeft:function(){return i.a.createElement(O.a,{style:{marginLeft:10},name:"md-menu",size:32,color:"#222",onPress:function(){return n.openDrawer()}})}})}},z=n(16),L=n.n(z),A=n(37),D=n(2),T=n(71),H=n(5),N=n(209),R=n(17),U=n.n(R),_=n(18),W=n(53),q=n(27),G=n(207),V=n(47),M=n(8),K=n.n(M),Q=n(9),X=n.n(Q),Y=function(){function e(){K()(this,e)}return X()(e,null,[{key:"baseFetch",value:function(e){var t,n;return U.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,U.a.awrap(fetch("https://services.surfline.com"+e,{headers:{Accept:"application/json","Content-Type":"application/json"}}));case 2:if((t=r.sent).ok){r.next=8;break}throw(n=new Error(t.statusText)).response=t,n.statusCode=t.status,n;case 8:return r.next=10,U.a.awrap(t.json());case 10:return r.abrupt("return",r.sent);case 11:case"end":return r.stop()}}),null,null,null,Promise)}},{key:"createParamString",value:function(e){return Object.keys(e).filter((function(t){return void 0!==e[t]&&null!==e[t]})).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}},{key:"searchSpots",value:function(e){var t,n,r;return U.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,U.a.awrap(this.baseFetch("/search/site?q="+e+"&querySize=1&suggestionSize=1"));case 2:if(t=a.sent,(n=t[0].hits.hits).length){a.next=6;break}return a.abrupt("return",null);case 6:return r=n[0],a.abrupt("return",{id:r._id,name:r._source.name,permalink:r._source.href});case 8:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"findPrimarySwell",value:function(e){return e[0]}},{key:"fetchReport",value:function(t){var n,r,a,o;return U.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,U.a.awrap(this.baseFetch("/kbyg/spots/reports?spotId="+t));case 2:return n=c.sent,r=n.spot.cameras[0],a=n.forecast,o=n.report,c.abrupt("return",{cam:{cameraStillUrl:null==r?void 0:r.stillUrl,cameraRewindClipUrl:null==r?void 0:r.rewindClip},forecast:{rating:a.conditions.value,wind:{speed:a.wind.speed,direction:a.wind.direction},weather:{temperature:a.weather.temperature},wave:{minHeight:a.waveHeight.min,maxHeight:a.waveHeight.max,occasionalHeight:a.waveHeight.occasional,plusHeight:a.waveHeight.plus,human:a.waveHeight.humanRelation},tide:{type:a.tide.current.type},primarySwell:e.findPrimarySwell(a.swells)},report:{body:null==o?void 0:o.body}});case 7:case"end":return c.stop()}}),null,this,null,Promise)}}]),e}(),Z=n(204),$=n.n(Z);function ee(e){return e?e.toLowerCase():null}function te(e){var t=e.occasionalHeight?" occ. "+e.occasionalHeight:"",n=e.plusHeight?"+":"";return e.minHeight+"-"+e.maxHeight+"ft"+t+n}function ne(e){return"Tide: "+e.type.toLowerCase()}function re(e){return"Wind: "+e.speed+"kts, "+e.direction+"\xb0"}function ae(e){return"Primary Swell: "+e.height+"ft at "+e.period+"s "+e.direction}function oe(e){var t=e.wave,n=e.wind,r=e.rating,a=e.tide,o=e.primarySwell;return[ee(r),te(t),ne(a),re(n),ae(o)].filter((function(e){return e})).join("\n")}var ce=Object(u.b)((function(e){return{spotFavorites:h.selectAll(e)}}))((function(e){var t,n=e.searchText,r=e.spotFavorites,a=Object(u.c)(),o=Object(c.useState)(!0),l=L()(o,2),s=l[0],m=l[1],d=Object(c.useState)(null),f=L()(d,2),p=f[0],b=f[1];if(Object(_.useFocusEffect)(i.a.useCallback((function(){var e=!0;return function(){var t,r;U.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return m(!0),a.prev=1,a.next=4,U.a.awrap(Y.searchSpots(n));case 4:if(!(t=a.sent)){a.next=10;break}return a.next=8,U.a.awrap(Y.fetchReport(t.id));case 8:r=a.sent,e&&b({report:r,spot:t});case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(1),e&&b(a.t0);case 15:return a.prev=15,m(!1),a.finish(15);case 18:case"end":return a.stop()}}),null,null,[[1,12,15,18]],Promise)}(),function(){e=!1}}),[n])),s)return i.a.createElement(G.a,{size:"large",animating:!0});if(p instanceof Error)return i.a.createElement(q.a,null,"Error: ",p.message);if(!p)return i.a.createElement(H.a,null);var E=null==(t=p.report)?void 0:t.cam.cameraStillUrl,h=r.find((function(e){return e.id===p.spot.id}));return i.a.createElement(V.a,{style:ie.container},i.a.createElement(H.a,{style:ie.saveButton},i.a.createElement(O.a.Button,{name:h?"star":"star-outline",backgroundColor:h?"green":"gold",onPress:function(){a(h?g.actions.removeSpotFavorite(p.spot.id):g.actions.spotFavoriteAdded(p.spot))}},h?"Unfavorite":"Favorite")),E?i.a.createElement(W.a,{style:ie.camImage,source:{uri:E}}):null,i.a.createElement(q.a,null,p.spot.name),i.a.createElement(q.a,null,function(e){var t=e.forecast,n=t.wave,r=t.wind,a=t.rating,o=t.tide,c=t.primarySwell;return[ee(a),te(n),ne(o),re(r),ae(c),"",e.report.body?$()(e.report.body):""].filter((function(e){return null!==e})).join("\n")}(p.report)))})),ie=D.a.create({container:{flex:1},saveButton:{marginBottom:30},camImage:{width:150,height:150,marginBottom:30}}),ue=function(){var e=Object(c.useState)(""),t=L()(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),o=L()(a,2),u=o[0],l=o[1];return i.a.createElement(H.a,{style:le.container},i.a.createElement(H.a,{style:le.searchBar},i.a.createElement(N.a,{value:n,keyboardType:"default",onChangeText:function(e){return r(e)},placeholder:"Search for a Spot",style:le.input,onSubmitEditing:function(){A.a.dismiss(),l(n)}}),i.a.createElement(T.a,{onPress:function(){A.a.dismiss(),l(n)},style:le.searchButton},i.a.createElement(O.a,{name:"search-circle",color:"blue",size:30}))),i.a.createElement(ce,{searchText:u}))},le=D.a.create({container:{flex:1,backgroundColor:"#fff",padding:10},searchBar:{flexDirection:"row"},searchButton:{flexGrow:0},input:{flexGrow:1,padding:4,marginBottom:20,borderBottomColor:"#ddd",borderBottomWidth:1}}),se=Object(S.a)(),me=function(){return i.a.createElement(se.Navigator,null,i.a.createElement(se.Screen,{name:"ForecastScreen",component:ue,options:I({title:"Forecast"})}))},de=function(e){var t=e.on,n=e.onPress;return i.a.createElement(O.a.Button,{name:t?"star":"star-outline",backgroundColor:"white",style:pe.star,color:"gold",onPress:n})},fe=function(e){return i.a.createElement(H.a,{style:pe.container},[1,2,3,4,5].map((function(t){return i.a.createElement(de,{key:"star-"+t,on:e.value>=t,onPress:function(){return e.onChange(t)}})})))},pe=D.a.create({container:{flexDirection:"row",justifyContent:"space-between",width:175},star:{width:30,height:30,marginEnd:5,padding:0}}),be=D.a.create({container:{flex:1,padding:20,backgroundColor:"#fff"},date:{fontSize:14,marginTop:10},body:{marginTop:10,fontSize:16},deleteButton:{marginTop:40}}),Ee=Object(u.b)((function(e,t){return{journalEntry:b.selectById(e,t.route.params.id)}}))((function(e){var t=e.navigation,n=e.journalEntry,r=Object(u.c)();if(c.useLayoutEffect((function(){t.setOptions({title:n?n.spot.name:"Not Found"})}),[t]),!n)return c.createElement(H.a,{style:be.container},c.createElement(q.a,null,"Not Found"));return c.createElement(H.a,{style:be.container},c.createElement(q.a,{style:be.date},new Date(n.createdAt).toLocaleString()),c.createElement(q.a,{style:be.body},n.body),c.createElement(q.a,{style:be.body},oe(n.forecast)),c.createElement(fe,{value:n.rating,onChange:function(){}}),c.createElement(H.a,{style:be.deleteButton},c.createElement(O.a.Button,{name:"trash-bin",backgroundColor:"red",onPress:function(){return U.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:r(p.actions.deleteJournalEntry(n.id)),t.pop();case 2:case"end":return e.stop()}}),null,null,null,Promise)}},"Delete")))})),ge=n(91),he=n(208),ye=function(e){return c.createElement(he.a,{onPress:function(){return e.onPress(e.journalEntry)},style:function(e){return[{backgroundColor:e.pressed?"#eee":"#fff"},ve.item]}},c.createElement(q.a,{style:ve.title},e.journalEntry.spot.name),c.createElement(q.a,{style:ve.date},new Date(e.journalEntry.createdAt).toLocaleString()))},ve=D.a.create({item:{padding:20},title:{fontSize:16},date:{marginTop:8,color:"#666",fontSize:14}}),we=function(){return c.createElement(H.a,{style:{height:D.a.hairlineWidth}})},je=function(){return c.createElement(H.a,{style:{flex:1,alignContent:"center",alignItems:"center"}},c.createElement(q.a,{style:{marginTop:30,fontSize:20}},"No Journal Entries"))},Se=function(e){return c.createElement(ge.a,{data:e.journalEntries,renderItem:function(t){var n=t.item;return c.createElement(ye,{journalEntry:n,onPress:e.onPressJournalEntry})},keyExtractor:function(e){return e.id},ItemSeparatorComponent:we,ListEmptyComponent:je})},Oe=Object(u.b)((function(e){return{journalEntries:b.selectAll(e)}}))((function(e){var t=e.navigation,n=e.journalEntries;return Object(c.useLayoutEffect)((function(){t.setOptions({headerRight:function(){return i.a.createElement(O.a.Button,{onPress:function(){return t.navigate("NewJournalEntryScreen")},backgroundColor:"white",name:"add",color:"blue",size:30})}})}),[t]),i.a.createElement(Se,{journalEntries:n,onPressJournalEntry:function(e){t.push("JournalEntryDetailsScreen",{id:e.id})}})})),ke=Object(S.a)(),xe=function(){return i.a.createElement(ke.Navigator,null,i.a.createElement(ke.Screen,{name:"JournalEntryListScreen",component:Oe,options:I({title:"Surf Journal"})}),i.a.createElement(ke.Screen,{name:"JournalEntryDetailsScreen",component:Ee}))},Ce=Object(k.a)(),Pe=Object(x.a)(),Be="ios"===C.a.OS?function(){return i.a.createElement(Ce.Navigator,{initialRouteName:"JournalEntriesStack"},i.a.createElement(Ce.Screen,{name:"JournalEntriesStack",component:xe,options:{tabBarLabel:"Journal",tabBarIcon:function(e){var t=e.focused,n=e.size,r=e.color;return i.a.createElement(O.a,{name:t?"journal":"journal-outline",size:n,color:r})}}}),i.a.createElement(Ce.Screen,{name:"ForecastStack",component:me,options:{tabBarLabel:"Forecast",tabBarIcon:function(e){var t=e.focused,n=e.size,r=e.color;return i.a.createElement(O.a,{name:t?"rainy":"rainy-outline",size:n,color:r})}}}))}:function(){return i.a.createElement(Pe.Navigator,{initialRouteName:"JournalEntriesStack"},i.a.createElement(Pe.Screen,{name:"JournalEntriesStack",component:xe,options:{drawerLabel:"Journal"}}),i.a.createElement(Pe.Screen,{name:"ForecastStack",component:me,options:{drawerLabel:"Forecast"}}))},Fe=n(133),Je=n(146),Ie=n.n(Je),ze=n(147),Le=n(52),Ae=Object(u.b)((function(e){return{spotFavorites:h.selectAll(e)}}))((function(e){var t=e.navigation,n=e.spotFavorites,r=Object(u.c)(),a=Object(c.useState)(""),o=L()(a,2),l=o[0],s=o[1],d=Object(c.useState)(0),f=L()(d,2),b=f[0],E=f[1],g=Object(c.useState)("invalid"),h=L()(g,2),y=h[0],v=h[1];return Object(c.useLayoutEffect)((function(){t.setOptions({headerLeft:null,headerRight:function(){return i.a.createElement(ze.a,{title:"Cancel",onPress:function(){return t.pop()}})}})}),[t]),i.a.createElement(H.a,{style:De.container},i.a.createElement(Le.a,{value:l,keyboardType:"default",onChangeText:function(e){return s(e)},placeholder:"Note",style:De.input}),i.a.createElement(fe,{value:b,onChange:function(e){return E(e)}}),i.a.createElement(Fe.a,{selectedValue:y,style:{height:50,width:100},onValueChange:function(e){return v(e)}},i.a.createElement(Fe.a.Item,{label:"Select a Spot",value:"invalid"}),n.map((function(e){return i.a.createElement(Fe.a.Item,{label:e.name,value:e.id})}))),i.a.createElement(ze.a,{onPress:function(){var e,a,o;return U.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,U.a.awrap(Y.fetchReport(Ie()(y)));case 3:o=c.sent,a=o.forecast,e=Ie()(n.find((function(e){return e.id===y}))),c.next=12;break;case 8:return c.prev=8,c.t0=c.catch(0),v("invalid"),c.abrupt("return");case 12:r(p.actions.journalEntryAdded({id:Object(m.e)(),body:l,createdAt:(new Date).toString(),spot:e,forecast:a,rating:b})),t.pop();case 14:case"end":return c.stop()}}),null,null,[[0,8]],Promise)},disabled:0===b||!l||"invalid"===y,title:"Save"}))})),De=D.a.create({container:{flex:1,padding:20,backgroundColor:"#fff"},input:{padding:4,marginBottom:20,borderBottomColor:"#ddd",borderBottomWidth:1}}),Te=Object(S.a)(),He=function(){return i.a.createElement(Te.Navigator,{mode:"modal"},i.a.createElement(Te.Screen,{name:"MainTabs",component:Be,options:{headerShown:!1}}),i.a.createElement(Te.Screen,{name:"NewJournalEntryScreen",component:Ae,options:{title:"Add Journal Entry"}}))};Object(a.a)((function(){return c.createElement(u.a,{store:w},c.createElement(l.a,{loading:null,persistor:j},c.createElement(r.a,null,c.createElement(o.a,{style:"auto"}),c.createElement(He,null))))}))}},[[215,1,2]]]);
//# sourceMappingURL=app.2ea82c16.chunk.js.map